<div
  class="modal fade"
  [class.show]="show"
  [style.display]="show ? 'block' : 'none'"
  tabindex="-1"
  role="dialog"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <i class="bi bi-arrow-repeat me-2"></i>
          {{ i18n.t('disbursements.resubmit.title') }}
        </h5>
        <button
          type="button"
          class="btn-close"
          (click)="onClose()"
          [disabled]="submitting"
        ></button>
      </div>

      <div class="modal-body">
        <div class="alert alert-info" role="alert">
          <i class="bi bi-info-circle me-2"></i>
          {{ i18n.t('disbursements.resubmit.instruction') }}
        </div>

        <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
          <i class="bi bi-exclamation-triangle me-2"></i>
          {{ errorMessage }}
        </div>

        <div class="mb-3">
          <label class="form-label">
            {{ i18n.t('disbursements.resubmit.comment') }}
            <span class="text-danger">*</span>
          </label>
          <textarea
            class="form-control"
            rows="4"
            [(ngModel)]="comment"
            [placeholder]="i18n.t('disbursements.resubmit.commentPlaceholder')"
            [disabled]="submitting"
          ></textarea>
          <small class="text-muted">
            {{ i18n.t('disbursements.resubmit.commentHelp') }}
          </small>
        </div>

        <div class="mb-3">
          <label class="form-label">
            {{ i18n.t('disbursements.resubmit.attachments') }}
            <span class="text-muted">({{ i18n.t('common.optional') }})</span>
          </label>
          <input
            type="file"
            class="form-control"
            (change)="onFileSelected($event)"
            multiple
            [disabled]="submitting"
            accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png"
          />
          <small class="text-muted">
            {{ i18n.t('disbursements.resubmit.allowedFiles') }}
          </small>
        </div>

        <div *ngIf="selectedFiles.length > 0" class="mb-3">
          <label class="form-label">{{ i18n.t('disbursements.resubmit.selectedFiles') }}:</label>
          <ul class="list-group">
            <li
              *ngFor="let file of selectedFiles; let i = index"
              class="list-group-item d-flex justify-content-between align-items-center"
            >
              <span>
                <i class="bi bi-file-earmark me-2"></i>
                {{ file.name }}
                <small class="text-muted ms-2">({{ (file.size / 1024).toFixed(2) }} KB)</small>
              </span>
              <button
                type="button"
                class="btn btn-sm btn-outline-danger"
                (click)="removeFile(i)"
                [disabled]="submitting"
              >
                <i class="bi bi-trash"></i>
              </button>
            </li>
          </ul>
        </div>
      </div>

      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="onClose()"
          [disabled]="submitting"
        >
          {{ i18n.t('common.cancel') }}
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="onSubmit()"
          [disabled]="submitting || !comment.trim()"
        >
          <span *ngIf="submitting">
            <span class="spinner-border spinner-border-sm me-2" role="status"></span>
            {{ i18n.t('disbursements.resubmit.submitting') }}
          </span>
          <span *ngIf="!submitting">
            <i class="bi bi-check-circle me-2"></i>
            {{ i18n.t('disbursements.resubmit.submit') }}
          </span>
        </button>
      </div>
    </div>
  </div>
</div>

<div
  class="modal-backdrop fade"
  [class.show]="show"
  *ngIf="show"
></div>
