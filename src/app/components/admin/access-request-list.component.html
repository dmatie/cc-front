<app-authenticated-navbar
  [title]="i18n.t('internal.nav.title')"
  [userType]="'internal'">
</app-authenticated-navbar>

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-12 col-lg-12">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
          <h4 class="mb-0">{{ i18n.t('admin.access_requests.title') }}</h4>
          <button class="btn btn-light btn-sm" (click)="goBack()">
            <i class="bi bi-arrow-left me-2"></i>{{ i18n.t('admin.access_requests.back') }}
          </button>
        </div>

        <div class="card-body">
          @if (isLoading) {
            <div class="text-center py-5">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">{{ i18n.t('admin.access_requests.loading') }}</span>
              </div>
              <p class="mt-3">{{ i18n.t('admin.access_requests.loading') }}</p>
            </div>
          } @else if (errorMessage) {
            <div class="alert alert-danger">
              <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ errorMessage }}
            </div>
          } @else if (requestResponse.accessRequests.length === 0) {
            <div class="text-center py-5">
              <i class="bi bi-inbox display-1 text-muted"></i>
              <p class="mt-3 text-muted">{{ i18n.t('admin.access_requests.no_requests') }}</p>
            </div>
          } @else {
            <div class="table-responsive">
              <table class="table table-hover align-middle">
                <thead class="table-light">
                  <tr>
                    <th>{{ i18n.t('admin.access_requests.table.name') }}</th>
                    <th>{{ i18n.t('admin.access_requests.table.email') }}</th>
                    <th>{{ i18n.t('admin.access_requests.table.financing_type') }}</th>
                    <th>{{ i18n.t('admin.access_requests.table.submission_date') }}</th>
                    <th>{{ i18n.t('admin.access_requests.table.status') }}</th>
                    <th class="text-center">{{ i18n.t('admin.access_requests.table.actions') }}</th>
                  </tr>
                </thead>
                <tbody>
                  @for (request of requestResponse.accessRequests; track request.id) {
                    <tr>
                      <td>
                        <strong>{{ request.firstName }} {{ request.lastName }}</strong>
                      </td>
                      <td>{{ request.email }}</td>
                      <td class="text-center">
                        <span class="badge badge-sm bg-secondary">{{ request.financingTypeName }}</span>
                      </td>
                      <td class="text-center">{{ request.submissionDate | date:'short' }}</td>
                      <td class="text-center">
                        <span class="badge badge-sm bg-warning">
                          {{ i18n.t('admin.access_requests.status.' + StatusMapper[request.status]) }}
                        </span>
                      </td>
                      <td class="text-center">
                        <button
                          class="btn btn-outline-primary btn-sm px-3"
                          (click)="viewDetail(request.id)">
                          <i class="bi bi-eye me-1"></i>{{ i18n.t('admin.access_requests.view_detail') }}
                        </button>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
